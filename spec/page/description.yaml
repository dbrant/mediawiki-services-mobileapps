paths:
  # from routes/page/description.js
  /{domain}/v1/page/description/{title}:
    get:
      tags:
        - Page content
      summary: Get article short description
      description: |
        Returns the article short description either from Wikidata or from
        local on-wiki description depending on the site.
      parameters:
        - $ref: '#/components/parameters/domainParam'
        - $ref: '#/components/parameters/title'
        - name: Accept-Language
          in: header
          description: |
            The desired language variant code for wikis where LanguageConverter is enabled.
            Example: `sr-Latn` for Latin transcription of the Serbian language.
          schema:
            type: string
      responses:
        200:
          $ref: '#/components/responses/description'
        404:
          description: Unknown page title or revision
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/problem'
        default:
          $ref: "#/components/responses/problem"
      x-amples:
        - title: Get description for test page
          request:
            params:
              title: San_Francisco
          response:
            status: 200
            headers:
              content-type: application/json; charset=utf-8; profile="https://www.mediawiki.org/wiki/Specs/description/0.0.1"
              content-language: en
              vary: /.+/
              access-control-allow-origin: '*'
              access-control-allow-headers: accept, x-requested-with, content-type
              content-security-policy: default-src 'none'; frame-ancestors 'none'
              x-content-security-policy: default-src 'none'; frame-ancestors 'none'
              x-frame-options: SAMEORIGIN
            body:
              description: /.+/
    put:
      tags:
        - Page content
      summary: Update article short description
      description: |
        Creates or updates the article short description either on Wikidata
        or on the local on-wiki description depending on the site.
      security:
        - oauth2: []
      parameters:
        - $ref: '#/components/parameters/domainParam'
        - $ref: '#/components/parameters/title'
        - name: Content-Language
          in: header
          description: |
            The description language code with variant. Defaults to the wiki main content language.
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                description:
                  description: New value for the article short description.
                  type: string
                comment:
                  description: Optional edit summary, will be prepended by autogenerated comment.
                  type: string
              required:
                - description
      responses:
        201:
          $ref: '#/components/responses/description'
        401:
          $ref: "#/components/responses/problem"
        501:
          $ref: "#/components/responses/problem"
        default:
          $ref: "#/components/responses/problem"
      x-monitor: false

    delete:
      tags:
        - Page content
      summary: Delete article short description
      description: |
        Deletes the article short description either from Wikidata
        or from the local on-wiki description depending on the site.
      security:
        - oauth2: []
      parameters:
        - $ref: '#/components/parameters/domainParam'
        - $ref: '#/components/parameters/title'
        - name: Content-Language
          in: header
          description: |
            The description language code with variant. Defaults to the wiki main content language.
          schema:
            type: string
      responses:
        204:
          description: The description was deleted successfully
        401:
          $ref: "#/components/responses/problem"
        501:
          $ref: "#/components/responses/problem"
        default:
          $ref: "#/components/responses/problem"
      x-monitor: false

components:
  responses:
    description:
      description: The short description for the given page
      headers:
        'Content-Language':
          schema:
            type: string
          description: The description language including variant if available
      content:
        'application/json; charset=utf-8; profile="https://www.mediawiki.org/wiki/Specs/description/0.0.1"':
          schema:
            $ref: '#/components/schemas/description'
  schemas:
    description:
      type: object
      properties:
        description:
          type: string
          description: short description for the page
          example: Russian poet
      additionalProperties: false

  securitySchemes:
    oauth2:
      type: http
      scheme: bearer
      bearerFormat: JWT

